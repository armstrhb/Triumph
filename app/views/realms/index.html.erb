<html>
<head>
  <%= stylesheet_link_tag 'realms', :media => 'all' %>
</head>
<body>
  <div class="container">
    <div class="jumbotron">
      <h1>Welcome to Your Realm!</h1>
      <button class="btn btn-lg btn-primary">HNNGH</button>
    </div>
    <hr>
    <p>You are currently a member of <%= pluralize(@realms.length, 'realm') %>.
      <button id="new-realm-button" class="btn" data-toggle="modal" data-target="#new-realm-modal">New Realm</button>
    </p>

    <% if @new_realm.errors.any? %>
      <div id="error-message" class="row">
        <div class="col-lg-12 error-count-message">
          <h4><%= pluralize(@new_realm.errors.count, "error") %> prohited realm creation:</h4>

          <ul>
            <% @new_realm.errors.full_messages.each do |msg| %>
              <li><%= msg %></li>
            <% end %>
          </ul>
        </div>
      </div>
    <% end %>

    <table id="realm-table" class='table table-striped table-hover'>
      <tr>
        <th>Realm</th>
        <th class='text-center'>Users</th>
        <th class='text-center'>Achievements</th>
        <th class='text-center'>Points Earned</th>
        <th>Admin Group</th>
      </tr>
      <%= render @realms %>
    </table>
    <hr>

    <div class="row">
      <div class="col-lg-4">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Achievements in Progress</h3>
          </div><!--end panel-heading -->
        <p>Cheevs</p>
        </div><!--end panel-default -->
      </div><!-- end col-lg-4 -->

      <div class="col-lg-4">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Your Groups</h3>
          </div><!--end panel-heading -->
        <p>Cheevs</p>
        </div><!--end panel-default -->
      </div><!-- end col-lg-4 -->

      <div class="col-lg-4">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Hipster Ipsum</h3>
          </div><!--end panel-heading -->
        <p>Cheevs</p>
        </div><!--end panel-default -->
      </div><!-- end col-lg-4 -->
    </div><!-- end row -->

    <div id="new-realm-modal" class="modal fade" tabindex="-1" aria-labelledby="myModalLabel" role="dialog" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel">Create Realm</h4>
          </div>
          <div class="modal-body">
          <%= form_for(@new_realm, :html => { :class => "form-inline"}, remote: true) do |f| %>
            <div class='form-group'>
              <%= f.label :name %>
              <%= f.text_field :name, :class => 'form-control' %>
              <!-- TODO admin group drop down -->
              <%= f.collection_select(:group_id, @groups.all, :id, :name, {}, {:class => 'form-control'}) %>
            </div>
            <%= f.submit :class => 'btn btn-primary' %>
            <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <% end %>
        </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    $.fn.modal_success = function(){
        this.modal('hide');
    };

    $("tr[data-link]").click(function() {
      window.location = this.dataset.link;
    });


  </script>
</body>
</html>
